# Render.com deployment configuration for Alemandan POS
# This file defines the services needed to deploy the application on Render

services:
  # Web Service - Spring Boot Application
  - type: web
    name: alemandan-pos
    env: docker
    # Use the Dockerfile in the repository root
    dockerfilePath: ./Dockerfile
    # No custom start command needed - ENTRYPOINT in Dockerfile handles it
    # Render will automatically set the PORT environment variable
    
    # Auto-deploy when code is pushed to this branch
    autoDeploy: true
    
    # Environment variables
    # IMPORTANT: You must configure these in Render Dashboard for your service
    envVars:
      # Database connection
      # Option 1: Use Render's managed Postgres (see database service below)
      # - key: DATABASE_URL
      #   fromDatabase:
      #     name: alemandan-pos-db
      #     property: connectionString
      
      # Option 2: Use MySQL or external database
      # Configure these in Render Dashboard:
      # - key: SPRING_DATASOURCE_URL
      #   value: jdbc:mysql://your-db-host:3306/crm_db?useSSL=false&serverTimezone=UTC
      # - key: SPRING_DATASOURCE_USERNAME
      #   value: your-db-username
      # - key: SPRING_DATASOURCE_PASSWORD
      #   value: your-db-password
      
      # Mail configuration (if using email features)
      # - key: SPRING_MAIL_HOST
      #   value: smtp.gmail.com
      # - key: SPRING_MAIL_PORT
      #   value: 587
      # - key: SPRING_MAIL_USERNAME
      #   value: your-email@gmail.com
      # - key: SPRING_MAIL_PASSWORD
      #   value: your-app-password
      
      # JPA/Hibernate settings
      # - key: SPRING_JPA_HIBERNATE_DDL_AUTO
      #   value: update
      # - key: SPRING_JPA_SHOW_SQL
      #   value: false  # Set to false in production
      
      # PORT is automatically provided by Render
      # The Dockerfile ENTRYPOINT uses it: -Dserver.port=${PORT}

  # Optional: Managed PostgreSQL Database
  # Uncomment and configure if you want to use Render's managed Postgres
  # Note: The application currently uses MySQL, so you'll need to:
  # 1. Add PostgreSQL driver to pom.xml, or
  # 2. Use an external MySQL database (recommended for compatibility)
  
  # - type: pserv  # PostgreSQL service type in Render
  #   name: alemandan-pos-db
  #   plan: free  # Change to a paid plan for production
  #   ipAllowList: []  # Allow connections from Render services only
  #   databases:
  #     - name: alemandan_pos_db
  #       user: alemandan_user

# Notes for deployment:
# 1. The application uses MySQL by default. You have two options:
#    a) Use an external MySQL database and configure SPRING_DATASOURCE_* env vars
#    b) Switch to PostgreSQL and update the driver in pom.xml
# 2. The PORT environment variable is automatically provided by Render
# 3. Set all required environment variables in the Render Dashboard
# 4. For file uploads, consider using cloud storage (S3, Cloudinary) instead of local filesystem
# 5. Review and update mail configuration if using email features
