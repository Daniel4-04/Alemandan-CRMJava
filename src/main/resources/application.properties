# Application name
spring.application.name=AlemandanPOSJava

# Server configuration
server.port=${PORT:8080}

# Datasource: allow overriding from environment (use Railway env vars in production)
# Default values keep local dev working (localhost)
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:mysql://localhost:3306/crm_db?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:root}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:}

# HikariCP connection pool settings (prevent connection exhaustion)
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000

# JPA / Hibernate
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect

# Thymeleaf
spring.thymeleaf.cache=false

# Mail: move credentials to env for security (defaults empty)
spring.mail.host=${SPRING_MAIL_HOST:smtp.gmail.com}
spring.mail.port=${SPRING_MAIL_PORT:587}
spring.mail.username=${SPRING_MAIL_USERNAME:}
spring.mail.password=${SPRING_MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=${SPRING_MAIL_HOST:smtp.gmail.com}

# SMTP timeout settings (prevent long hangs on connection failures)
spring.mail.properties.mail.smtp.connectiontimeout=10000
spring.mail.properties.mail.smtp.timeout=10000
spring.mail.properties.mail.smtp.writetimeout=10000

# SendGrid API configuration (use API instead of SMTP when configured)
sendgrid.api.key=${SENDGRID_API_KEY:}
sendgrid.sender.email=${SENDER_EMAIL:noreply@alemandanpos.com}

# Application base URL for email links (set in production, defaults to localhost for dev)
app.base.url=${APP_BASE_URL:http://localhost:8080}

# Password reset token configuration
security.password.reset.token.expiration-minutes=${PASSWORD_RESET_TOKEN_EXPIRATION_MINUTES:60}
security.password.reset.min-password-length=${PASSWORD_RESET_MIN_PASSWORD_LENGTH:8}

# Uploads / multipart config
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=20MB
# Location where Spring can store temporary multipart files
spring.servlet.multipart.location=uploads
# Path where your app will save uploaded files
uploads.path=uploads

# Performance and resource optimization
server.tomcat.max-threads=50
server.tomcat.min-spare-threads=10
spring.main.lazy-initialization=true

# Logging configuration
logging.level.org.springframework.mail=INFO
logging.level.com.alemandan.crm=INFO
# Optional logging for multipart
logging.level.org.springframework.web.multipart=DEBUG